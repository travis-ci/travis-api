language: ruby
rvm: '2.3.4'
cache: bundler
addons:
  postgresql: 9.6
services:
  - redis
before_install:
  - 'gem install bundler -v 1.17.3'
before_script:
  - cp config/travis.example.yml config/travis.yml
  - "createdb travis_test || true"
  - "curl -fs https://raw.githubusercontent.com/travis-ci/travis-migrations/master/db/main/structure.sql | psql travis_test"
script: RAILS_ENV=test bundle exec rake spec
