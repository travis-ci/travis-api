<section class="info-block">
  <% if @organization.present? %>
    <h2 class="info-header">Repositories</h2>
  <%else%>
    <h2 class="info-header">Repositories with Admin Access</h2>
    <%end%>
  <% if @repositories.empty? %>
    <p>No repositories.</p>
  <% else %>
    <ul>
      <li class="inline-list repository-item">
        <p class="info-label repo-name">Repository</p>
        <p class="info-label repo-visibility">Visibility</p>
        <p class="info-label repo-active">Active?</p>
        <p class="info-label repo-build">Last Build</p>
      </li>
      <% @repositories.each do |repo| %>
        <li class="inline-list repository-item">
          <p class="repo-name"><%= link_to describe(repo), repository_path(repo) %></p>
          <% if repo.active? %>
            <p class="repo-active">&#10004; enabled</p>
          <% else %>
            <p class="repo-active">&#10008; disabled</p>
          <% end %>
          <% if repo.private? %>
              <p class="repo-visibility">private</p>
          <% else %>
              <p class="repo-visibility">public</p>
          <% end %>
          <% if repo.last_build_id %>
            <p class="repo-build">
              <%= link_to "build ##{repo.last_build_number}", repo.last_build %>
              <%= "(#{repo.last_build.state} at #{repo.last_build.state_time})" %>
            </p>
          <% else %>
            <p class="repo-build">no build</p>
          <% end %>
        </li>
      <% end %>
    </ul>
  <% end %>
  <% if @repositories_push.present? %>
    <h2 class="info-header">Repositories with PUSH access</h2>
    <% if @repositories_push.empty? %>
      <p>No repositories.</p>
    <% else %>
      <ul>
        <li class="inline-list repository-item">
          <p class="info-label repo-name">Repository</p>
          <p class="info-label repo-visibility">Visibility</p>
          <p class="info-label repo-active">Active?</p>
          <p class="info-label repo-build">Last Build</p>
        </li>
        <% @repositories_push.each do |repo| %>
          <li class="inline-list repository-item">
            <p class="repo-name"><%= link_to describe(repo), repository_path(repo) %></p>
            <% if repo.active? %>
              <p class="repo-active">&#10004; enabled</p>
            <% else %>
              <p class="repo-active">&#10008; disabled</p>
            <% end %>
            <% if repo.private? %>
              <p class="repo-visibility">private</p>
            <% else %>
              <p class="repo-visibility">public</p>
            <% end %>
            <% if repo.last_build_id %>
              <p class="repo-build">
              <%= link_to "build ##{repo.last_build_number}", repo.last_build %>
              <%= "(#{repo.last_build.state} at #{repo.last_build.state_time})" %>
              </p>
            <% else %>
              <p class="repo-build">no build</p>
            <% end %>
          </li>
        <% end %>
      </ul>
    <% end %>
  <% end %>
  <% if @repositories_pull.present? %>
    <h2 class="info-header">Repositories with PULL access</h2>

    <% if @repositories_pull.empty? %>
      <p>No repositories.</p>
    <% else %>
      <ul>
        <li class="inline-list repository-item">
          <p class="info-label repo-name">Repository</p>
          <p class="info-label repo-visibility">Visibility</p>
          <p class="info-label repo-active">Active?</p>
          <p class="info-label repo-build">Last Build</p>
        </li>
        <% @repositories_pull.each do |repo| %>
          <li class="inline-list repository-item">
            <p class="repo-name"><%= link_to describe(repo), repository_path(repo) %></p>
            <% if repo.active? %>
              <p class="repo-active">&#10004; enabled</p>
            <% else %>
              <p class="repo-active">&#10008; disabled</p>
            <% end %>
            <% if repo.private? %>
              <p class="repo-visibility">private</p>
            <% else %>
              <p class="repo-visibility">public</p>
            <% end %>
            <% if repo.last_build_id %>
              <p class="repo-build">
              <%= link_to "build ##{repo.last_build_number}", repo.last_build %>
              <%= "(#{repo.last_build.state} at #{repo.last_build.state_time})" %>
              </p>
            <% else %>
              <p class="repo-build">no build</p>
            <% end %>
          </li>
        <% end %>
      </ul>
    <% end %>
  <% end %>
  <%#= will_paginate @repositories, param_name: 'page', params: {controller: controller_name, action: 'repositories', id: params[:id], anchor: 'repositories'}, 'data-remote': true %>
</section>
