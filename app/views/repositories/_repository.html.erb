<section class="info-block">
  <h2 class="info-header">Basic Information</h2>

  <dl class="simple-info">
    <dt class="info-label">Name:</dt>
    <dd>
      <%= describe(@repository) %>
      <%= link_to fa_icon("github"), "https://github.com/#{describe(@repository)}", target: "_blank" %>
    </dd>

    <dt class="info-label">Description:</dt>
    <dd><%= @repository.description %></dd>

    <dt class="info-label">Visibility:</dt>
    <dd><%= @repository.private? ? "private" : "public" %></dd>

    <dt class="info-label">Default Branch:</dt>
    <dd><%= @repository.default_branch %></dd>

    <dt class="info-label">Repository Owner:</dt>
    <dd>
      <% if @repository.owner.avatar_url %>
        <%= image_tag(@repository.owner.avatar_url, size: "20x20", alt: "Avatar", class: "avatar") %>
      <% end %>
      <%= link_to describe(@repository.owner), @repository.owner %></dd>
  </dl>
</section>

<section class="info-block">
  <h2 class="info-header">Status</h2>

  <dl class="simple-info">
    <dt class="info-label">Last Build:</dt>
    <dd>
      <% if @repository.last_build_id %>
        <%= link_to "##{@repository.last_build_number}", @repository.last_build %>
        <%= "(#{@repository.last_build.state} at #{@repository.last_build.state_time})" %>
      <% else %>
        No Build.
      <% end %>
    </dd>

    <dt class="info-label">Activation:</dt>
    <dd class="inline">
      <p><%= @repository.active? ? "enabled" : "disabled" %></p>
      <% if @repository.active? %>
        <%= button_to "Disable", disable_repository_path(@repository), form_class: "disable-button", class: "button" %>
      <% else %>
        <%= button_to "Enable", enable_repository_path(@repository), form_class: "enable-button", class: "button" %>
      <% end %>
    </dd>
  </dl>
</section>

<section class="info-block">
  <h2 class="info-header">Feature Flags</h2>
  <%= render partial: 'shared/features_for', locals: {owner: @repository} %>
</section>

<section class="info-block">
  <h2 class="info-header">Settings</h2>

  <%= form_for :settings, url: {controller: "settings", action: "update"} do |f| %>
    <% Settings::BINARY.each do |key| %>
      <p>
        <%= f.check_box key, checked: @settings.send(key) %>
        <%= f.label key %>
      </p>
    <% end %>

    <% Settings::INTEGER.each do |key| %>
      <p>
        <%= f.text_field key, value: @settings.send(key) %>
        <%= f.label key %>
      </p>
    <% end %>

    <%= f.submit('Update', class: 'button', id: 'update-settings') %>
  <% end %>
</section>

